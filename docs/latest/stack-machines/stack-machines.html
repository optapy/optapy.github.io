<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Stack Machines Introduction :: Documentation</title>
    <link rel="canonical" href="https://www.optapy.org/docs/latest/stack-machines/stack-machines.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="stylesheet" href="../../../_/css/menu.css"><!-- Adobe Analytics for Red Hat - DPAL (DTM Property Auto-Loader) - part 1/2 -->
<script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
<!-- Google Analytics for kie team: Global site tag (gtag.js) -->
<script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://www.optapy.org">
          <img src="../../../_/img/optaPyLogoDarkBackground200px.png" alt="OptaPy logo"/>
        </a>
        <a class="navbar-item" href="https://www.optapy.org">
          Documentation
        </a>
      </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/optapy">Get Help</a>
        <div class="navbar-item">
          <a class="navbar-item small-item" href="https://github.com/optapy/optapy" title="Follow OptaPy on GitHub"><img src="https://img.shields.io/github/stars/optapy/optapy?style=flat&logo=github" alt="GitHub" /></a>
          <a class="navbar-item small-item" href="https://twitter.com/OptaPlanner" target="_blank" title="Follow OptaPlanner on Twitter"><img alt="T" src="../../../_/img/twitterLogo.png"></a>
          <a class="navbar-item small-item" href="https://www.linkedin.com/showcase/optaplanner" target="_blank" title="Follow OptaPlanner on LinkedIn"><img alt="L" src="../../../_/img/linkedInLogo.png"></a>
          <a class="navbar-item small-item" href="https://www.facebook.com/OptaPlanner" target="_blank" title="Follow OptaPlanner on Facebook"><img alt="F" src="../../../_/img/facebookLogo.png"></a>
          <a class="navbar-item small-item" href="https://www.youtube.com/channel/UCcpkOKpujFlM67D2h0RdaeQ" target="_blank" title="OptaPlanner YouTube channel"><img alt="YT" src="../../../_/img/youtubeLogo.png" style="height: 16px"></a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">OptaPy User Guide 9.37.0b0</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">User Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../planner-introduction/planner-introduction.html">OptaPy Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../quickstart/quickstart.html">Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../planner-configuration/planner-configuration.html">OptaPy configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../score-calculation/score-calculation.html">Score calculation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../constraint-streams/constraint-streams.html">Constraint streams score calculation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../shadow-variable/shadow-variable.html">Shadow variable</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../optimization-algorithms/optimization-algorithms.html">Optimization algorithms</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../move-and-neighborhood-selection/move-and-neighborhood-selection.html">Move and neighborhood selection</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../exhaustive-search/exhaustive-search.html">Exhaustive search</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../construction-heuristics/construction-heuristics.html">Construction heuristics</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../local-search/local-search.html">Local search</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../evolutionary-algorithms/evolutionary-algorithms.html">Evolutionary algorithms</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../partitioned-search/partitioned-search.html">Partitioned search</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../repeated-planning/repeated-planning.html">Repeated planning</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../design-patterns/design-patterns.html">Design patterns</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Developer Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jpyinterpreter-introduction/jpyinterpreter-introduction.html">JPyInterpreter Introduction</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="stack-machines.html">Stack Machines Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../python-function-structure/python-function-structure.html">Python Function Structure</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../opcodes/opcodes.html">CPython Opcode Instructions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../java-bytecode/java-bytecode.html">Java Bytecode</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jpyinterpreter-architecture/jpyinterpreter-architecture.html">JPyInterpreter Architecture</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">OptaPy User Guide 9.37.0b0</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">OptaPy User Guide 9.37.0b0</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../planner-introduction/planner-introduction.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">OptaPy User Guide 9.37.0b0</a></li>
    <li>Developer Guide</li>
    <li><a href="stack-machines.html">Stack Machines Introduction</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/optapy/optapy/edit/main/optapy-docs/src/modules/ROOT/pages/stack-machines/stack-machines.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Stack Machines Introduction</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section uses a fake stack machine language for educational purposes, and is unrelated to both the Java bytecode machine language and the CPython bytecode machine language.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="whatIsAStackMachine"><a class="anchor" href="#whatIsAStackMachine"></a>1. What is a Stack Machine?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Stack Machine is a type of virtual machine that uses a stack to store intermediary inputs and results.
For instance, this program:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def my_fun(x: int):
    return x + 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>when compiled to a stack machine language, may look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">LOAD_LOCAL 0 (x)
LOAD_CONSTANT 0 (1)
ADD
RETURN</code></pre>
</div>
</div>
<div class="paragraph">
<p>The stack starts initially empty, and each operation modifies it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// []
LOAD_LOCAL 0 (x) // push x to the stack

// [x]
LOAD_CONSTANT 0 (1) // push 1 to the stack

// [x, 1]
ADD // pop top two elements (x, 1) and push their sum

// [(x+1)]
RETURN // returns TOS (x+1) to the caller</code></pre>
</div>
</div>
<div class="paragraph">
<p>The stack is often not the only means of storage. Usually, there are local variables that can also be read and written to. For instance, this function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def test(x):
    a = x + x
    b = x * x
    return a + b</code></pre>
</div>
</div>
<div class="paragraph">
<p>when compiled to a stack machine language, may look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// stack: [] locals: {}
LOAD_LOCAL 0 (x)

// stack: [x] locals: {}
DUP_TOP

// stack: [x, x] locals: {}
ADD

// stack: [(x + x)] locals: {}
STORE_LOCAL 1 (a)

// stack: [], locals: {a: x+x}
LOAD_LOCAL 0 (x)

// stack: [x], locals: {a: x+x}
DUP_TOP

// stack: [x, x], locals: {a: x+x}
MULTIPLY

// stack: [(x*x)], locals: {a: x+x}
STORE_LOCAL 2 (b)

// stack: [], locals: {a: x+x, b: x*x}
LOAD_LOCAL 1 (a)

// stack: [x+x], locals: {a: x+x, b: x*x}
LOAD_LOCAL 2 (b)

// stack: [x+x, x*x], locals: {a: x+x, b: x*x}
ADD

// stack: [(x+x) + (x*x)] locals: {a: x+x, b: x*x}
RETURN</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jumpsInAStackMachine"><a class="anchor" href="#jumpsInAStackMachine"></a>2. Jumps in a Stack Machine</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A stack machine opcode could conditionally jump to a different location. For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def test(x):
    a = 0
    if x &lt; 10:
        a += x
    return a</code></pre>
</div>
</div>
<div class="paragraph">
<p>when compiled to a stack machine language, may look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// stack: [] locals: {}
LOAD_CONSTANT 0 (0)

// stack: [0] locals: {}
STORE_LOCAL 1 (a)

// stack: [] locals: {a: 0}
LOAD_LOCAL 0 (x)

// stack: [x] locals: {a: 0}
LOAD_CONSTANT 1 (10)

// stack: [x, 1] locals: {a: 0}
LESS_THAN

// stack: [Type&lt;bool&gt;] locals: {a: 0}
POP_JUMP_IF_FALSE skip_if &gt;---------------|
                                          |
// stack: [] locals: {a: 0}               |
LOAD_LOCAL 1 (a)                          |
                                          |
// stack: [a] locals: {a: 0}              |
LOAD_LOCAL 0 (x)                          |
                                          |
// stack: [a, x] locals: {a: 0}           |
ADD                                       |
                                          |
// stack: [(a+x)] locals: {a: 0}          |
STORE_LOCAL 1 (a)                         |
                                          |
[label skip_if]                           |
// stack: [] locals: {a: 0 or (0 + x)}    |
LOAD_LOCAL 1 (a) &lt;------------------------|

// stack: [a] locals: {a: 0 or (0 + x)}
RETURN</code></pre>
</div>
</div>
<div class="paragraph">
<p>In particular, the instruction after <code>POP_JUMP_IF_FALSE</code> will be the instruction after <code>skip_if</code> if TOS is False. If TOS is True, it will be the instruction after <code>POP_JUMP_IF_FALSE</code> instead. We call the possible next instruction(s) for a given instruction that instruction&#8217;s target(s).</p>
</div>
<div class="paragraph">
<p>This means the instruction after the label <code>skip_if</code> has
two possible predecessors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>POP_JUMP_IF_FALSE</code> if TOS was False</p>
</li>
<li>
<p><code>STORE_LOCAL (a + x)</code> if TOS was True</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In most stack based languages, stack state must be consistent.
This means, among other things, the number of elements in the stack for a given opcode must be the same for all possible predecessors. For example, the following stack machine program is invalid:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// stack: []
LOAD_LOCAL 0 (x)

// stack: [x]
LOAD_CONSTANT 0 (10)

// stack: [x, 10]
LESS_THAN

// stack: [Type&lt;bool&gt;]
POP_JUMP_IF_TRUE skip_if &gt;-----------------------------------------|
                                                                   |
// stack: []                                                       |
LOAD_CONSTANT 0 (10)                                               |
                                                                   |
[label skip_if]                                                    |
// Cannot compute stack; stack size mismatch [10] (1) vs [] (0)    |
LOAD_CONSTANT 0 (10)&lt;----------------------------------------------|

// ???
RETURN</code></pre>
</div>
</div>
<div class="paragraph">
<p>The  <code>if</code> block pushed an extra element to the stack, but did not pop it, causing an inconsistent stack size after the if
(either 1, if the branch was taken, or 0,  if it was not).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_differences_between_java_and_the_cpython_virtual_machines"><a class="anchor" href="#_differences_between_java_and_the_cpython_virtual_machines"></a>3. Differences between Java and the CPython Virtual Machines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Java and CPython virtual machines have a number of differences:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In Java, the compiler is allowed to introduce "extra"
local variables not declared in the source program. This
is because local variables in the JVM are stored in slots,
and the number of slots does not need to match the number
of local variables. In contrast, every local variable
in the CPython virtual machine correlates to a declared
local variable in the function, which is stored in a
dictionary. This leads to CPython using the stack as
storage for compiler local variables. For instance,</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def my_fun(iterable):
    total = 0
    for item in iterable:
        total += item
    return total</code></pre>
</div>
</div>
<div class="paragraph">
<p>translates roughly to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// [], locals: {}
LOAD_CONSTANT 1 (0)

// [0], locals: {}
STORE_LOCAL 1 (total)

// [], locals: {total: 0}
LOAD_LOCAL 0 (iterable)

// [iterable], locals: {total: 0}
GET_ITER

[forStart]&lt;---------------------------------------------------------|
// [iter(iterable)], locals: {total: int}                           |
FOR_ITER afterFor &gt;-------------------------------------------------+--|
                                                                    |  |
// [iter(iterable), int], locals: {total: int}                      |  |
STORE_LOCAL 2 (item)                                                |  |
                                                                    |  |
// [iter(iterable)], locals: {total: int, item: int}                |  |
LOAD_LOCAL 1 (total)                                                |  |
                                                                    |  |
// [iter(iterable), total], locals: {total: int, item: int}         |  |
LOAD_LOCAL 2 (item)                                                 |  |
                                                                    |  |
// [iter(iterable), total, item], locals: {total: int, item: int}   |  |
BINARY_OP 13 (+=)                                                   |  |
                                                                    |  |
// [iter(iterable), (total += item)]                                |  |
STORE_LOCAL 1 (total)                                               |  |
                                                                    |  |
// [iter(iterable)], locals: {total: int, item: int}                |  |
GOTO forStart&gt;------------------------------------------------------|  |
                                                                       |
[afterFor]&lt;------------------------------------------------------------|
// [], locals: {total: int, item: int}
LOAD_LOCAL 1 (total)

// [total], locals: {total: int, item: int}
RETURN_VALUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that despite the fact <code>iter(iterable)</code> is not used inside
the for block, it remains on the stack for the entire duration of the for block so it can be reused by <code>FOR_ITER</code>.
In Java, the above code instead would roughly translate to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// [], locals: {}
LOAD_CONSTANT 0 (0)

// [0], locals: {}
STORE_LOCAL 1 (total)

// [], locals: {total: 0}
LOAD_LOCAL 0 (iterable)

// [iterable], locals: {total: 0}
INVOKE iterator()

// [iterable.iterator()], locals: {total: 0}
STORE_LOCAL 2 (iterator)

[forStart]&lt;---------------------------------------------------------|
// [], locals: {total: 0, iterator: iterator}                       |
LOAD_LOCAL 2 (iterator)                                             |
                                                                    |
// [iterator], locals: {total: 0, iterator: iterator}               |
INVOKE hasNext()                                                    |
                                                                    |
// [boolean], locals: {total: 0, iterator: iterator}                |
JUMP_IF_FALSE afterFor &gt;--------------------------------------------+--|
                                                                    |  |
// [], locals: {total: int}                                         |  |
LOAD_LOCAL 2 (iterator)                                             |  |
                                                                    |  |
// [iterator], locals: {total: int}                                 |  |
INVOKE next         |                                               |  |
                                                                    |  |
// [int], locals: {total: int}                                      |  |
STORE_LOCAL 3 (item)                                                |  |
                                                                    |  |
// [], locals: {total: int, item: int}                              |  |
LOAD_LOCAL 1 (total)                                                |  |
                                                                    |  |
// [total], locals: {total: int, item: int}                         |  |
LOAD_LOCAL 3 (item)                                                 |  |
                                                                    |  |
// [total, item], locals: {total: int, item: int}                   |  |
INT_ADD                                                             |  |
                                                                    |  |
// [total + item]                                                   |  |
STORE_LOCAL 1 (total)                                               |  |
                                                                    |  |
// [], locals: {total: int, item: int}                              |  |
GOTO forStart&gt;------------------------------------------------------|  |
                                                                       |
[afterFor]&lt;------------------------------------------------------------|
// [], locals: {total: int, item: int}
LOAD_LOCAL 1 (total)

// [total], locals: {total: int, item: int}
RETURN_VALUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is, instead of the iterator remaining on the stack, it got stored in a compiler local variable.</p>
</div>
</li>
<li>
<p>The stack state is before a try-block is preserved in Python, so it can
be restored when an exception occurs. Thus, when an exception occurs in
CPython, the stack state is <code>&lt;stack before try&gt;, &lt;exception info&gt;</code>
(where <code>&lt;exception info&gt;</code> is either <code>&lt;frame info&gt;, traceback, exception, exception_type</code> if the Python version is before Python 3.11, <code>exception</code>
otherwise). In contrast, after an exception occurs in Java, the stack state is
<code>exception</code>. For example, this code:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def my_fun(session_list):
    for session in session_list:
        try:
            session.start()
        except IOError as e:
            print('Could not start session: ' + str(e))</code></pre>
</div>
</div>
<div class="paragraph">
<p>translates roughly in python (3.11) to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// [], {}
LOAD_LOCAL 0 (session_list)

// [session_list], {}
GET_ITER

[forStart]
// [iter], {}
FOR_ITER after_for

[tryStart]
// [iter, any], {}
STORE_LOCAL 1 (session)

// [iter], {session: any}
LOAD_LOCAL 1 (session)

// [iter, session], {session: any}
LOAD_METHOD 'start'

// [iter, session, method], {session: any}
CALL 1

// [iter], {session: any}
GOTO forStart

[except]
// [iter, exception], {}
PUSH_EXC_INFO

// [iter, exception, exception], {}
LOAD_GLOBAL 2 (IOERROR)

// [iter, exception, exception, IOError], {}
CHECK_EXC_MATCH

// [iter, exception, bool], {}
POP_JUMP_FORWARD_IF_FALSE finally

[ioError]
// [iter, exception], {}
STORE_LOCAL 2 (e)

// [iter], {e: Error}
LOAD_GLOBAL 5 (print)

// [iter, print], {e: Error}
LOAD_CONST 1 ('Could not start session: ')

// [iter, print, msg], {e: Error}
LOAD_GLOBAL 7 (str)

// [iter, print, msg, str], {e: Error}
LOAD_LOCAL 2 (e)

// [iter, print, msg, str, e], {e: Error}
CALL 1

// [iter, print, msg, str(e)], {e: Error}
BINARY_OP 0 (+)

// [iter, print, msg + str(e)], {e: Error}
CALL 1

// [iter, None], {e: Error}
POP_TOP

// [iter], {e: Error}
POP_EXCEPT

// [iter], {e: Error}
LOAD_CONST 0 (None)

// [iter, None], {e: Error}
STORE_LOCAL 2 (e)

// [iter], {e: None}
DELETE_LOCAL 2 (e)

// [iter], {}
GOTO forStart

[exceptionInExceptFinally]
// [iter, exception], {}
LOAD_CONST 0 (None)

// [iter, exception, None], {}
STORE_FAST 2 (e)

// [iter, exception], {e: None}
DELETE_FAST 2 (e)

// [iter, exception], {}
RERAISE

[unmatchExceptionTypeFinally]
// [iter, exception], {}
RERAISE

[exceptionInSetupCleanupFinally]
// [iter, exception], {}
POP_EXCEPT

// [iter, exception], {}
RERAISE

[forEnd]
// [], {}
LOAD_CONST               0 (None)

// [None], {}
RETURN_VALUE

ExceptionHandlers:
    Any: (tryStart, except) -&gt; except
    Any: (except, ioError) -&gt; exceptionInSetupCleanupFinally
    Any: (ioError, exceptionInExceptFinally) -&gt; exceptionInExceptFinally
    Any: (exceptionInExceptFinally, unmatchExceptionTypeFinally) -&gt; exceptionInSetupCleanupFinally</code></pre>
</div>
</div>
<div class="paragraph">
<p>(In 3.10 and below, the ExceptionHandlers are done via the SETUP_FINALLY opcode which create the corresponding try/except blocks). In Java, the above code would instead roughly translate to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// [], {}
LOAD_LOCAL 0 (session_list)

// [session_list], {}
INVOKE iterator()

// [iterator], {}
STORE_LOCAL 3 (iterator)

[forStart]
// [], {iterator: iterator}
LOAD_LOCAL 3 (iterator)

// [iterator], {iterator: iterator}
INVOKE hasNext()

// [bool], {iterator: iterator}
JUMP_IF_FALSE afterFor

// [], {iterator: iterator}
LOAD_LOCAL 3 (iterator)

// [iterator], {iterator: iterator}
INVOKE next()

[tryStart]

// [item], {iterator: iterator}
STORE_LOCAL 1 (session)

// [], {iterator: iterator, session: item}
LOAD_LOCAL 1 (session)

// [item], {iterator: iterator, session: item}
INVOKE start()

// [], {iterator: iterator, session: item}
GOTO forStart

[except]
// [exception], {iterator: iterator}
STORE_LOCAL 2 (e)

// [], {iterator: iterator, e: exception}
LOAD_CONST 1 ('Could not start session: ')

// [message], {iterator: iterator, e: exception}
LOAD_LOCAL 2 (e)

// [message, e], {iterator: iterator, e: exception}
INVOKE toString()

// [message, e.toString()], {iterator: iterator, e: exception}
INVOKE concat(String)

// [message + e.toString()], {iterator: iterator, e: exception}
INVOKESTATIC print(String)

// [], {iterator: iterator, e: exception}
GOTO forStart

[exceptionInExceptFinally]
// [exception], {iterator: iterator}
THROW

[forEnd]
// [], {iterator: iterator}
LOAD_CONST 0 (None)

// [None], {iterator: iterator}
RETURN_VALUE

ExceptionHandlers:
    IOError: (tryStart, except) -&gt; except
    Any: (tryStart, exceptionInExceptFinally) -&gt; exceptionInSetupCleanupFinally</code></pre>
</div>
</div>
</li>
<li>
<p>Methods and types are objects on the stack in CPython. In contrast, methods and types are arguments to opcodes in Java. For example, this Python code:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def my_function(obj):
    return obj.my_function()</code></pre>
</div>
</div>
<div class="paragraph">
<p>roughly translates to this bytecode in CPython</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// []
LOAD_LOCAL 0 (obj)

// [obj]
LOAD_METHOD 'my_function'

// [obj, my_function]
CALL 1

// [value]
RETURN_VALUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Java, it would roughly translate to this instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// []
LOAD_LOCAL 0 (obj)

// [obj]
INVOKE ObjectType::my_function()

// [value]
RETURN_VALUE</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>

<!-- Adobe Analytics for Red Hat - DPAL (DTM Property Auto-Loader) - part 2/2 -->
<script type="text/javascript">
    if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
        _satellite.pageBottom();
    }
</script>  </body>
</html>
